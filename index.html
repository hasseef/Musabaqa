<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Ù…Ø³Ø§Ø¨Ù‚Ø© â€“ Ù†Ù…ÙˆØ°Ø¬ Ù…Ø³ØªÙ‚Ø±</title>
    <style>
      body{margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, 'Noto Sans Arabic', 'Noto Naskh Arabic', 'Segoe UI Emoji', 'Apple Color Emoji', 'Segoe UI Symbol', sans-serif; background: linear-gradient(to bottom, #eef2ff, #fff); color:#111827;}
      .nav{position:sticky; top:0; background:#ffffffdd; backdrop-filter: blur(6px); border-bottom:1px solid #e5e7eb;}
      .nav-inner{display:flex; align-items:center; justify-content:space-between; gap:12px; padding:12px 16px; max-width:1200px; margin:0 auto;}
      .brand{display:flex; align-items:center; gap:8px; font-weight:700;}
      .brand-badge{width:28px; height:28px; border-radius:12px; background:#4f46e5;}
      .tab{padding:6px 12px; border-radius:10px; font-size:14px; color:#374151; border:none; background:transparent; cursor:pointer;}
      .tab-active{background:#111827; color:#fff;}
      .container{max-width:1100px; margin:0 auto; padding: 24px;}
      .card{background:#fff; border:1px solid #e5e7eb; border-radius:16px; padding:16px;}
      .pill{display:inline-block; padding:4px 8px; border-radius:999px; background:#eef2ff; color:#4338ca; border:1px solid #c7d2fe; font-size:12px;}
      .grid{display:grid; gap:12px;}
      .grid-2{grid-template-columns: 1fr 1fr;}
      .grid-3{grid-template-columns: repeat(3, 1fr);}
      .grid-4{grid-template-columns: repeat(4, 1fr);}
      @media (max-width:900px){ .grid-2, .grid-3, .grid-4{grid-template-columns: 1fr;} }
      .btn{padding:8px 16px; border-radius:12px; background:#4f46e5; color:#fff; font-size:14px; border:none; cursor:pointer;}
      .btn:hover{background:#4338ca;}
      .btn-outline{padding:8px 16px; border-radius:12px; border:1px solid #4f46e5; color:#4338ca; font-size:14px; background:#fff; cursor:pointer;}
      .input{width:100%; padding:8px 12px; border:1px solid #e5e7eb; border-radius:12px; font-size:14px;}
      .textarea{width:100%; height:100px; padding:8px 12px; border:1px solid #e5e7eb; border-radius:12px; font-size:14px;}
      .footer{margin-top:48px; border-top:1px solid #e5e7eb; background:#ffffffc0;}
      .footer-inner{max-width:1200px; margin:0 auto; padding:16px; display:flex; align-items:center; gap:12px; justify-content:space-between; color:#6b7280; font-size:14px;}
      .muted{color:#6b7280; font-size:14px;}
      .hidden{display:none;}
    </style>
  </head>
  <body>
    <div class="nav">
      <div class="nav-inner">
        <div class="brand"><span class="brand-badge"></span><span>Ù…Ø³Ø§Ø¨Ù‚Ø©</span></div>
        <div>
          <button class="tab tab-active" data-tab="landing">Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©</button>
          <button class="tab" data-tab="individual">ÙØ±Ø¯</button>
          <button class="tab" data-tab="entity">Ø¬Ù‡Ø©</button>
          <button class="tab" data-tab="sponsor">Ø±Ø§Ø¹Ù</button>
          <button class="tab" data-tab="admin">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
          <button class="tab" data-tab="investor">Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±</button>
        </div>
        <div><button class="btn">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯ÙŠ</button></div>
      </div>
    </div>

    <main id="view"></main>

    <div class="footer">
      <div class="footer-inner">
        <div>Â© <span id="y"></span> Musabaqa â€” Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</div>
        <div style="display:flex;gap:16px">
          <a href="#" class="muted">Ø§Ù„Ø®ØµÙˆØµÙŠØ©</a>
          <a href="#" class="muted">Ø§Ù„Ø´Ø±ÙˆØ·</a>
          <a href="#" class="muted">Ø§Ù„Ø¯Ø¹Ù…</a>
        </div>
      </div>
    </div>

    <script>
      document.getElementById('y').textContent = new Date().getFullYear();
      const view = document.getElementById('view');

      const state = {
        route: 'landing',
        competitions: [
          { id: 'c1', title:'Ø§Ù„ØªÙˆØ¹ÙŠØ© Ø¨Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø±Ù‚Ù…ÙŠ', type:'ØªÙˆØ¹ÙˆÙŠØ©', owner:'ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…', city:'Ø§Ù„Ø±ÙŠØ§Ø¶', prize:1000, prizeType:'Ø±Ù‚Ù…ÙŠØ©', status:'Ù…ÙØªÙˆØ­Ø©', winners:3, participants:[] },
          { id: 'c2', title:'ØªØ­Ø¯ÙŠ Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø¬Ø¯ÙŠØ¯', type:'ØªØ³ÙˆÙŠÙ‚ÙŠØ©', owner:'Ø´Ø±ÙƒØ© ØªÙ…ÙˆÙŠÙ† Ø§Ù„ØºØ°Ø§Ø¡', city:'Ø¬Ø¯Ø©', prize:5000, prizeType:'Ø¹ÙŠÙ†ÙŠØ©', status:'Ù…ÙØªÙˆØ­Ø©', winners:1, participants:[] },
          { id: 'c3', title:'Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø¨ÙŠØ¦Ø© â€“ ÙÙƒØ±Ø© Ù…Ø¨ØªÙƒØ±Ø© Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù‡Ø¯Ø±', type:'ØªÙˆØ¹ÙˆÙŠØ©', owner:'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ¦Ø©', city:'Ø§Ù„Ø¯Ù…Ø§Ù…', prize:3000, prizeType:'Ù†Ù‚Ø¯ÙŠØ©', status:'Ù…ØºÙ„Ù‚Ø©', winners:2, participants:[{user:'Ø³Ø§Ø±Ø©', city:'Ø§Ù„Ø±ÙŠØ§Ø¶'},{user:'Ø®Ø§Ù„Ø¯', city:'Ø§Ù„Ø¯Ù…Ø§Ù…'}] }
        ],
        user: { name:'ÙÙ‡Ø¯', city:'Ø§Ù„Ø±ÙŠØ§Ø¶', interests:['Ø§Ù„Ø«Ù‚Ø§ÙØ©','Ø§Ù„ØªÙ‚Ù†ÙŠØ©','Ø§Ù„Ø±ÙŠØ§Ø¶Ø©'] },
        sponsor: { org:'Ø´Ø±ÙƒØ© ØªÙ…ÙˆÙŠÙ† Ø§Ù„ØºØ°Ø§Ø¡', wallet:25000 }
      };

      function SAR(n){ return new Intl.NumberFormat('ar-SA',{style:'currency',currency:'SAR'}).format(n); }
      function fmt(n){ return new Intl.NumberFormat('ar-SA').format(n); }

      function render(){
        const active = state.competitions.filter(c=> c.status!=='Ù…ØºÙ„Ù‚Ø©').length;
        const participations = state.competitions.reduce((a,c)=> a + c.participants.length, 0);
        const prizesClosed = state.competitions.filter(c=> c.status==='Ù…ØºÙ„Ù‚Ø©').reduce((a,c)=> a + c.winners, 0);
        const prizeValue = state.competitions.reduce((a,c)=> a + c.prize, 0);
        const sponsors = 7;
        const users = 58000;

        const R = {
          landing: `
            <div class="container">
              <div class="grid grid-2" style="align-items:center">
                <div>
                  <h1 style="font-size:34px;font-weight:900;line-height:1.25">Ù…Ø³Ø§Ø¨Ù‚Ø© â€” Ø­ÙˆÙ„ Ø¬Ù…Ù‡ÙˆØ±Ùƒ Ø¥Ù„Ù‰ <span style="color:#4f46e5">Ù…ØªÙØ§Ø¹Ù„ÙŠÙ† ÙØ¹Ù„ÙŠÙ‹Ø§</span></h1>
                  <p class="muted" style="margin-top:8px">Ù…Ù†ØµØ© ÙˆØ·Ù†ÙŠØ© Ù„Ù„Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø§Ù„ØªÙˆØ¹ÙˆÙŠØ© ÙˆØ§Ù„ØªØ³ÙˆÙŠÙ‚ÙŠØ© ØªØ±Ø¨Ø· Ø§Ù„ØªØ­ÙÙŠØ² Ø¨Ø§Ù„Ù‚ÙŠØ§Ø³ Ø§Ù„Ø°ÙƒÙŠ Ù„Ù„Ø£Ø«Ø±.</p>
                  <div style="display:flex;flex-wrap:wrap;gap:8px;margin-top:10px">
                    <button class="btn" data-go="individual">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯ÙŠ (ÙØ±Ø¯)</button>
                    <button class="btn-outline" data-go="entity">Ù„Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ©/ØºÙŠØ± Ø§Ù„Ø±Ø¨Ø­ÙŠØ©</button>
                    <button class="btn-outline" data-go="sponsor">Ù„Ù„Ø±Ø¹Ø§Ø© ÙˆØ§Ù„Ø´Ø±ÙƒØ§Øª</button>
                    <button class="btn" style="background:#111827" data-go="investor">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±</button>
                  </div>
                  <div style="display:flex;gap:8px;margin-top:10px">
                    <span class="pill">RTL</span><span class="pill">ØªÙ‚Ø§Ø±ÙŠØ± ØªÙØ§Ø¹Ù„ÙŠØ©</span><span class="pill">Ù…Ø­ÙØ¸Ø© Ø±Ù‚Ù…ÙŠØ©</span><span class="pill">Ø¬ÙˆØ§Ø¦Ø² Ù†Ù‚Ø¯ÙŠØ©/Ø±Ù‚Ù…ÙŠØ©/Ø¹ÙŠÙ†ÙŠØ©</span>
                  </div>
                </div>
                <div class="card">
                  <div class="grid grid-3">
                    ${Stat('Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©', fmt(active))}
                    ${Stat('Ù…Ø´Ø§Ø±ÙƒØ§Øª', fmt(participations))}
                    ${Stat('Ø¬ÙˆØ§Ø¦Ø² Ù…ÙØ³Ù„Ù‘ÙÙ…Ø©', fmt(prizesClosed))}
                    ${Stat('Ø±Ø¹Ø§Ø© Ù†Ø´Ø·ÙˆÙ†', fmt(sponsors))}
                    ${Stat('Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¬ÙˆØ§Ø¦Ø²', SAR(prizeValue))}
                    ${Stat('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†', fmt(users))}
                  </div>
                </div>
              </div>
              <h3 style="font-size:18px;font-weight:700;margin:12px 0 8px">Ù…Ù† ÙŠØ®Ø¯Ù…Ù‡Ù… Ø§Ù„Ù†Ø¸Ø§Ù…ØŸ</h3>
              <div class="grid grid-4">
                ${AccountCard('individual','Ø§Ù„Ø£ÙØ±Ø§Ø¯','Ù…Ø´Ø§Ø±ÙƒØ©/Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø¨Ù‚Ø§Øª ÙˆØ§Ø³ØªÙ„Ø§Ù… Ø¬ÙˆØ§Ø¦Ø²')}
                ${AccountCard('entity','Ø¬Ù‡Ø§Øª Ø­ÙƒÙˆÙ…ÙŠØ©/ØºÙŠØ± Ø±Ø¨Ø­ÙŠØ©','Ø¥Ø·Ù„Ø§Ù‚ Ù…Ø³Ø§Ø¨Ù‚Ø§Øª ØªÙˆØ¹ÙˆÙŠØ© ÙˆØªÙ‚Ø§Ø±ÙŠØ± Ø£Ø«Ø±')}
                ${AccountCard('sponsor','Ø§Ù„Ø´Ø±ÙƒØ§Øª/Ø§Ù„Ø±Ø¹Ø§Ø©','Ø±Ø¹Ø§ÙŠØ©/Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø¨Ù‚Ø§Øª ÙˆØªØ­Ù„ÙŠÙ„ ROI')}
                ${AccountCard('investor','Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±','Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ§Ù„Ù†Ù…Ùˆ Ø§Ù„Ù…Ø§Ù„ÙŠ')}
              </div>
              <h3 style="font-size:18px;font-weight:700;margin:12px 0 8px">Ø´Ø±ÙƒØ§Ø¡ ÙˆØªØ¬Ø§Ø±Ø¨</h3>
              <div class="card">
                <div class="grid grid-4" style="text-align:center;color:#6b7280">
                  <div class="card">ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ¦Ø© (ØªØ¬Ø±ÙŠØ¨ÙŠ)</div>
                  <div class="card">ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ… (ØªØ¬Ø±ÙŠØ¨ÙŠ)</div>
                  <div class="card">Ø´Ø±ÙƒØ© ØªÙ…ÙˆÙŠÙ† Ø§Ù„ØºØ°Ø§Ø¡</div>
                  <div class="card">Ø¬Ø§Ù…Ø¹Ø© Ø­Ø§Ø¦Ù„</div>
                </div>
              </div>
            </div>
          `,
          individual: `
            <div class="container">
              <h2 style="font-size:22px;font-weight:800;margin-bottom:10px">Ù…Ø±Ø­Ø¨Ù‹Ø§ ${state.user.name} ğŸ‘‹</h2>
              <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px">
                <span class="pill">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©: ${state.user.city}</span>
                <span class="pill">Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª: ${state.user.interests.join('ØŒ ')}</span>
                <select id="cityFilter" class="input">
                  <option value="">ÙƒÙ„ Ø§Ù„Ù…Ø¯Ù†</option><option>Ø§Ù„Ø±ÙŠØ§Ø¶</option><option>Ø¬Ø¯Ø©</option><option>Ø§Ù„Ø¯Ù…Ø§Ù…</option>
                </select>
              </div>
              <div class="grid grid-2">
                ${state.competitions.filter(c=> c.status!=='Ù…ØºÙ„Ù‚Ø©').map(c => `
                  <div class="card">
                    <div style="display:flex;align-items:center;justify-content:space-between">
                      <div style="font-weight:700">${c.title}</div>
                      <span class="pill">${c.type}</span>
                    </div>
                    <div class="muted" style="margin-top:4px">${c.owner} â€¢ ${c.city}</div>
                    <div style="font-size:14px;margin-top:8px">Ø§Ù„Ø¬Ø§Ø¦Ø²Ø©: ${SAR(c.prize)} (${c.prizeType}) â€¢ Ø¹Ø¯Ø¯ Ø§Ù„ÙØ§Ø¦Ø²ÙŠÙ†: ${c.winners}</div>
                    <textarea class="textarea" data-answer="${c.id}" placeholder="Ø§ÙƒØªØ¨ Ø¥Ø¬Ø§Ø¨ØªÙƒ Ø¨Ø¥ÙŠØ¬Ø§Ø²"></textarea>
                    <div style="display:flex;gap:8px;margin-top:8px">
                      <button class="btn" data-participate="${c.id}">Ø£Ø´Ø§Ø±Ùƒ Ø§Ù„Ø¢Ù†</button>
                      <button class="btn-outline">Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø©</button>
                    </div>
                  </div>
                `).join('')}
              </div>
            </div>
          `,
          entity: `
            <div class="container">
              <h2 style="font-size:22px;font-weight:800;margin-bottom:10px">Ù„ÙˆØ­Ø© Ø§Ù„Ø¬Ù‡Ø©: ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ… â€“ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆØ¹ÙŠ Ø§Ù„Ø±Ù‚Ù…ÙŠ</h2>
              <div class="card">
                <h3 style="font-size:18px;font-weight:700;margin-bottom:8px">Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø¨Ù‚Ø© ØªÙˆØ¹ÙˆÙŠØ©</h3>
                <div class="grid grid-2">
                  <input id="e-title" class="input" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø©" />
                  <select id="e-type" class="input"><option>ØªÙˆØ¹ÙˆÙŠØ©</option><option>Ø«Ù‚Ø§ÙÙŠØ©</option><option>ØªØ³ÙˆÙŠÙ‚ÙŠØ©</option></select>
                  <select id="e-city" class="input"><option>Ø§Ù„Ø±ÙŠØ§Ø¶</option><option>Ø¬Ø¯Ø©</option><option>Ø§Ù„Ø¯Ù…Ø§Ù…</option></select>
                  <input id="e-winners" class="input" type="number" min="1" value="1" />
                  <input id="e-prize" class="input" type="number" min="0" value="1000" />
                  <select id="e-ptype" class="input"><option>Ø±Ù‚Ù…ÙŠØ©</option><option>Ù†Ù‚Ø¯ÙŠØ©</option><option>Ø¹ÙŠÙ†ÙŠØ©</option></select>
                </div>
                <div style="display:flex;gap:8px;margin-top:8px">
                  <button class="btn" id="e-create">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø©</button>
                  <button class="btn-outline">Ø­ÙØ¸ Ù…Ø³ÙˆØ¯Ø©</button>
                </div>
              </div>
            </div>
          `,
          sponsor: `
            <div class="container">
              <h2 style="font-size:22px;font-weight:800;margin-bottom:10px">Ù„ÙˆØ­Ø© Ø§Ù„Ø±Ø§Ø¹ÙŠ: ${state.sponsor.org}</h2>
              <div class="grid grid-3">
                ${Stat('Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©', SAR(state.sponsor.wallet), 'ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹ Ù„Ø§Ø­Ù‚Ù‹Ø§')}
                ${Stat('Ø­Ù…Ù„Ø§Øª Ù…ÙØªÙˆØ­Ø© Ù„Ù„Ø±Ø¹Ø§ÙŠØ©', fmt(state.competitions.filter(c=> c.status==='Ù…ÙØªÙˆØ­Ø©').length))}
                ${Stat('Ù…ØªÙˆØ³Ø· Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¬ÙˆØ§Ø¦Ø²', SAR(avgPrize()))}
              </div>
              <div class="grid grid-2" style="margin-top:12px">
                <div class="card">
                  <h3 style="font-size:18px;font-weight:700;margin-bottom:8px">Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø¨Ù‚Ø© ØªØ³ÙˆÙŠÙ‚ÙŠØ©</h3>
                  <div class="grid grid-2">
                    <input id="s-title" class="input" style="grid-column:1 / -1" value="Ø­Ù…Ù„Ø© ØªØ±ÙˆÙŠØ¬ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©" />
                    <select id="s-type" class="input"><option>ØªØ³ÙˆÙŠÙ‚ÙŠØ©</option><option>Ø«Ù‚Ø§ÙÙŠØ©</option></select>
                    <select id="s-city" class="input"><option>Ø§Ù„Ø±ÙŠØ§Ø¶</option><option>Ø¬Ø¯Ø©</option><option>Ø§Ù„Ø¯Ù…Ø§Ù…</option></select>
                    <input id="s-winners" class="input" type="number" value="1" />
                    <input id="s-prize" class="input" type="number" value="2000" />
                    <select id="s-ptype" class="input"><option>Ø±Ù‚Ù…ÙŠØ©</option><option>Ù†Ù‚Ø¯ÙŠØ©</option><option>Ø¹ÙŠÙ†ÙŠØ©</option></select>
                  </div>
                  <div style="margin-top:8px"><button class="btn" id="s-create">Ø¥Ù†Ø´Ø§Ø¡</button></div>
                </div>
                <div class="card">
                  <h3 style="font-size:18px;font-weight:700;margin-bottom:8px">Ø±Ø¹Ø§ÙŠØ© Ù…Ø³Ø§Ø¨Ù‚Ø© Ù‚Ø§Ø¦Ù…Ø©</h3>
                  <div id="s-open"></div>
                </div>
              </div>
            </div>
          `,
          admin: `
            <div class="container">
              <h2 style="font-size:22px;font-weight:800;margin-bottom:10px">Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h2>
              <div class="grid grid-2">
                ${state.competitions.map(c => `
                  <div class="card">
                    <div style="display:flex;align-items:center;justify-content:space-between">
                      <div style="font-weight:700">${c.title}</div>
                      <span class="pill">${c.status}</span>
                    </div>
                    <div class="muted" style="margin-top:4px">${c.owner} â€¢ ${c.type} â€¢ ${c.city}</div>
                    <div style="font-size:14px;margin-top:8px">Ù…Ø´Ø§Ø±ÙƒÙˆÙ†: ${c.participants.length} â€¢ Ø§Ù„Ø¬Ø§Ø¦Ø²Ø©: ${SAR(c.prize)} â€¢ ÙØ§Ø¦Ø²ÙˆÙ†: ${c.winners}</div>
                    <div style="display:flex;gap:8px;margin-top:8px">
                      ${c.status==='Ù…Ø³ÙˆØ¯Ø©' ? `<button class="btn" data-approve="${c.id}">Ø§Ø¹ØªÙ…Ø§Ø¯</button>` : ''}
                      ${c.status!=='Ù…ØºÙ„Ù‚Ø©' ? `<button class="btn-outline" data-close="${c.id}">Ø¥ØºÙ„Ø§Ù‚</button>` : ''}
                      <button class="btn" style="background:#4338ca" data-pick="${c.id}">ÙØ±Ø² Ø§Ù„ÙØ§Ø¦Ø²ÙŠÙ†</button>
                    </div>
                  </div>
                `).join('')}
              </div>
            </div>
          `,
          investor: `
            <div class="container">
              <h2 style="font-size:22px;font-weight:800;margin-bottom:10px">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±</h2>
              <div class="grid grid-3">
                ${Stat('Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†', fmt(users), 'Ù†Ù…Ùˆ Ø´Ù‡Ø±ÙŠ 12%')}
                ${Stat('Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø´Ù‡Ø±ÙŠØ©', SAR(185000), 'ØªØ±Ø§ÙƒÙ…ÙŠ ØªØ¬Ø±ÙŠØ¨ÙŠ')}
                ${Stat('Ø±Ø¹Ø§Ø© Ù†Ø´Ø·ÙˆÙ†', fmt(sponsors))}
              </div>
              <div class="card" style="margin-top:12px">
                <h3 style="font-size:18px;font-weight:700;margin-bottom:8px">Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©</h3>
                <div class="grid grid-2">
                  ${Stat('Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ù†Ø´Ø·Ø©', fmt(active))}
                  ${Stat('Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¬ÙˆØ§Ø¦Ø² Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©', SAR(prizeValue))}
                </div>
                <div class="muted" style="margin-top:8px">* Ù‡Ø°Ù‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ø§ÙƒØ§Ø© Ù„Ù„Ø¹Ø±Ø¶ ÙÙ‚Ø· â€” ÙŠÙ…ÙƒÙ† Ø±Ø¨Ø·Ù‡Ø§ Ø¨Ù…ØµØ¯Ø± Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ù‚ÙŠÙ‚ÙŠ Ù„Ø§Ø­Ù‚Ù‹Ø§.</div>
              </div>
            </div>
          `
        };

        view.innerHTML = R[state.route];

        // Wire basic interactions
        document.querySelectorAll('[data-go]').forEach(btn => btn.addEventListener('click', e => { routeTo(e.target.getAttribute('data-go')); }));
        if(state.route === 'individual'){
          document.querySelectorAll('[data-participate]').forEach(btn => btn.addEventListener('click', e => {
            const cid = e.target.getAttribute('data-participate');
            const ta = document.querySelector(`[data-answer="${cid}"]`);
            const answer = ta.value.trim();
            if(!answer){ alert('ÙØ¶Ù„Ø§Ù‹ Ø§ÙƒØªØ¨ Ù…Ø´Ø§Ø±ÙƒØªÙƒ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„'); return; }
            const c = state.competitions.find(x=> x.id===cid);
            c.participants.push({ user: state.user.name, city: state.user.city, answer });
            ta.value = '';
            alert('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ù…Ø´Ø§Ø±ÙƒØªÙƒ Ø¨Ù†Ø¬Ø§Ø­ âœ…');
          }));
        }
        if(state.route === 'entity'){
          document.getElementById('e-create').addEventListener('click', () => {
            const entry = {
              id: 'c'+Date.now(),
              title: val('e-title') || 'Ù…Ø³Ø§Ø¨Ù‚Ø© Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†',
              type: val('e-type'),
              owner: 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…',
              city: val('e-city'),
              prize: Number(val('e-prize'))||0,
              prizeType: val('e-ptype'),
              status: 'Ù…ÙØªÙˆØ­Ø©',
              winners: Number(val('e-winners'))||1,
              participants: []
            };
            state.competitions.unshift(entry);
            alert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø© ÙˆÙ†Ø´Ø±Ù‡Ø§ âœ…');
            routeTo('admin');
          });
        }
        if(state.route === 'sponsor'){
          document.getElementById('s-create').addEventListener('click', () => {
            const entry = {
              id: 'c'+Date.now(),
              title: val('s-title'),
              type: val('s-type'),
              owner: state.sponsor.org,
              city: val('s-city'),
              prize: Number(val('s-prize'))||0,
              prizeType: val('s-ptype'),
              status: 'Ù…ÙØªÙˆØ­Ø©',
              winners: Number(val('s-winners'))||1,
              participants: []
            };
            state.competitions.unshift(entry);
            alert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„ØªØ³ÙˆÙŠÙ‚ÙŠØ© âœ…');
            routeTo('admin');
          });
          // render open comps for quick fund
          const open = state.competitions.filter(c=> c.status==='Ù…ÙØªÙˆØ­Ø©');
          const holder = document.getElementById('s-open');
          holder.innerHTML = open.map(c => `
            <div style="display:flex;align-items:center;justify-content:space-between;border:1px solid #e5e7eb;border-radius:12px;padding:12px;margin-bottom:8px">
              <div><div style="font-weight:700">${c.title}</div><div class="muted">${c.owner} â€¢ ${c.city}</div></div>
              <div style="display:flex;gap:8px;align-items:center">
                <input class="input" style="width:110px" type="number" min="100" value="1000" data-amt="${c.id}" />
                <button class="btn" data-fund="${c.id}">ØªÙ…ÙˆÙŠÙ„</button>
              </div>
            </div>`).join('');
          holder.querySelectorAll('[data-fund]').forEach(btn => btn.addEventListener('click', e => {
            const cid = e.target.getAttribute('data-fund');
            const inp = holder.querySelector(`[data-amt="${cid}"]`);
            const amt = Number(inp.value)||0;
            if(amt<=0) return;
            const c = state.competitions.find(x=> x.id===cid);
            c.prize += amt;
            state.sponsor.wallet = Math.max(0, state.sponsor.wallet - amt);
            alert('ØªÙ… Ø§Ù„ØªÙ…ÙˆÙŠÙ„ ÙˆØ¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© âœ…');
            routeTo('sponsor');
          }));
        }
        if(state.route === 'admin'){
          document.querySelectorAll('[data-close]').forEach(btn => btn.addEventListener('click', e => {
            const cid = e.target.getAttribute('data-close');
            const c = state.competitions.find(x=> x.id===cid);
            c.status = 'Ù…ØºÙ„Ù‚Ø©';
            render();
          }));
          document.querySelectorAll('[data-pick]').forEach(btn => btn.addEventListener('click', e => {
            const cid = e.target.getAttribute('data-pick');
            const c = state.competitions.find(x=> x.id===cid);
            const shuffled = c.participants.slice().sort(()=> Math.random()-0.5);
            const winners = shuffled.slice(0, c.winners);
            alert(`ØªÙ… Ø§Ø®ØªÙŠØ§Ø± ${winners.length} ÙØ§Ø¦Ø²/Ø©:\n` + winners.map(w=>`â€¢ ${w.user} (${w.city})`).join('\n'));
          }));
        }
      }

      function Stat(label, value, sub){
        return `<div class="card"><div style="font-weight:800;font-size:22px">${value}</div><div class="muted">${label}</div>${sub?`<div class="muted" style="font-size:12px;margin-top:4px">${sub}</div>`:''}</div>`;
      }
      function AccountCard(key, title, desc){
        return `<div class="card" data-go="${key}" style="cursor:pointer"><div style="font-weight:700">${title}</div><div class="muted" style="margin-top:4px">${desc}</div></div>`;
      }
      function val(id){ const el = document.getElementById(id); return el?el.value:''; }
      function routeTo(tab){
        state.route = tab;
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('tab-active'));
        const btn = document.querySelector(`.tab[data-tab="${tab}"]`);
        if(btn) btn.classList.add('tab-active');
        render();
      }
      function avgPrize(){
        const open = state.competitions.filter(c=> c.status==='Ù…ÙØªÙˆØ­Ø©');
        if(open.length===0) return 0;
        return Math.round(open.reduce((a,c)=> a + c.prize, 0) / open.length);
      }

      // Init
      document.querySelectorAll('.tab').forEach(btn => btn.addEventListener('click', e => routeTo(btn.getAttribute('data-tab'))));
      render();
    </script>
  </body>
</html>
