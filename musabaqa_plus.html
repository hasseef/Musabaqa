<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta name="theme-color" content="#0f172a" />
    <title>Ù…Ø³Ø§Ø¨Ù‚Ø© â€“ Ù†Ø³Ø®Ø© Ø°ÙƒÙŠØ© Ù„Ù„Ø¬ÙˆØ§Ù„</title>
    <style>
      :root{
        --bg: #0b1020; --card: #0f172a; --muted: #94a3b8; --text: #e5e7eb;
        --accent: #6d93ff; --accent-2: #22d3ee; --ok: #22c55e; --warn: #f59e0b;
        --radius: 14px; --shadow: 0 6px 24px rgba(0,0,0,.25);
      }
      *{box-sizing:border-box} html,body{height:100%}
      body{margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, 'Noto Sans Arabic', 'Noto Naskh Arabic', 'Segoe UI Emoji', 'Apple Color Emoji', 'Segoe UI Symbol', sans-serif;
        background: radial-gradient(1200px 500px at 70% -80%, rgba(109,147,255,.25), transparent 60%),
                   radial-gradient(800px 400px at 0% 0%, rgba(34,211,238,.18), transparent 60%),
                   linear-gradient(to bottom, #0b1020, #0b1020 20%, #0d1224 60%, #0b1020);
        color:var(--text);
      }
      .container{max-width:1100px; margin:0 auto; padding: 14px;}
      .nav{position:sticky; top:0; z-index:30; background:rgba(11,16,32,.8); backdrop-filter: blur(12px); border-bottom:1px solid rgba(255,255,255,.08)}
      .nav-inner{display:flex; align-items:center; justify-content:space-between; gap:8px; padding:8px 10px; max-width:1150px; margin:0 auto;}
      .brand{display:flex; align-items:center; gap:8px; font-weight:800;}
      .brand-badge{width:28px; height:28px; border-radius:10px; background:linear-gradient(135deg, var(--accent), var(--accent-2)); box-shadow: var(--shadow);}
      .logos{display:flex; align-items:center; gap:8px}
      .logo{display:inline-flex; align-items:center; justify-content:center; height:26px; padding:2px 6px; border-radius:999px; background:#0b1224; border:1px solid rgba(255,255,255,.08); opacity:.95}
      .logo img{height:18px; display:block}
      .nav-buttons{display:flex; gap:4px; align-items:center; flex-wrap:wrap}
      .tab{padding:7px 10px; border-radius:10px; font-size:13px; color:#cbd5e1; border:none; background:transparent; cursor:pointer}
      .tab-active{background:#111c36; color:#fff; box-shadow: inset 0 0 0 1px rgba(255,255,255,.06)}
      .cta{padding:8px 10px; border-radius:12px; background:linear-gradient(135deg,#4f46e5,#22d3ee); color:#0b1020; font-weight:700; border:none; cursor:pointer}

      .grid{display:grid; gap:12px;} .grid-2{grid-template-columns:1fr 1fr} .grid-3{grid-template-columns:repeat(3,1fr)} .grid-4{grid-template-columns:repeat(4,1fr)}
      @media (max-width:980px){ .grid-2,.grid-3,.grid-4{grid-template-columns:1fr} }
      .card{background: linear-gradient(180deg,#101a34,#0f172a); border:1px solid rgba(255,255,255,.06); border-radius:var(--radius); padding:14px; box-shadow: var(--shadow);}
      .pill{display:inline-block; padding:4px 8px; border-radius:999px; background:rgba(109,147,255,.12); color:#b9ccff; border:1px solid rgba(109,147,255,.28); font-size:12px; white-space:nowrap}
      .muted{color:var(--muted); font-size:14px}
      .input,.textarea,select{width:100%; padding:10px 12px; border:1px solid rgba(255,255,255,.12); border-radius:12px; background:#0b1224; color:var(--text); font-size:15px; outline:none}
      .input:focus,.textarea:focus,select:focus{box-shadow: 0 0 0 3px rgba(79,70,229,.35)}
      .textarea{height:100px; resize:vertical}
      .btn{padding:10px 14px; border-radius:12px; background:#1d2a5b; color:#dbeafe; font-size:14px; border:1px solid rgba(255,255,255,.14); cursor:pointer}
      .btn:hover{background:#233064} .btn-accent{padding:10px 14px; border-radius:12px; background:#4f46e5; color:white; font-weight:700; border:1px solid rgba(255,255,255,.14); cursor:pointer}
      .btn-ghost{padding:10px 12px; border-radius:12px; color:#bcd0ff; font-size:14px; border:1px dashed rgba(188,208,255,.25); background:transparent; cursor:pointer}
      .hero-title{font-size:28px; font-weight:900; line-height:1.25; margin:0 0 6px} .hero-sub{color:#b6c2da; margin:0 0 8px; font-size:15px}
      .kpis{display:grid; gap:12px; grid-template-columns: repeat(3, 1fr);} @media (max-width:980px){ .kpis{grid-template-columns:1fr} }
      .stat-title{color:#9fb0d1; font-size:13px} .stat-value{font-weight:900; font-size:22px; color:#f1f5f9}
      .footer{margin-top:40px; border-top:1px solid rgba(255,255,255,.08); background:rgba(11,16,32,.75);} .footer-inner{max-width:1150px; margin:0 auto; padding:16px; display:flex; align-items:center; gap:12px; justify-content:space-between; color:#9aa6bd; font-size:14px}
      .video{border-radius:12px; overflow:hidden; aspect-ratio:16/9; background:#000; border:1px solid rgba(255,255,255,.12)}
      .share{display:flex; gap:8px; flex-wrap:wrap}
      .hint{font-size:12px; color:#93c5fd}
    </style>
  </head>
  <body>
    <header class="nav">
      <div class="nav-inner">
        <div class="brand" aria-label="Ø¹Ù„Ø§Ù…Ø© Ù…Ø³Ø§Ø¨Ù‚Ø©">
          <span class="brand-badge"></span><span>Ù…Ø³Ø§Ø¨Ù‚Ø©</span>
        </div>
        <div class="logos" aria-label="Ø´Ø¹Ø§Ø±Ø§Øª Ø¯Ø§Ø¹Ù…Ø©">
          <span class="logo" title="Vision 2030"><img src="Vision2030.png" alt="Vision 2030"/></span>
          <span class="logo" title="Ù…Ø¨Ø§Ø¯Ø±Ø© ØªÙ„Ø¨ÙŠØ©"><img src="talbiya.png" alt="Talabiya"/></span>
        </div>
        <div class="nav-buttons">
          <button class="tab tab-active" data-tab="landing">Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©</button>
          <button class="tab" data-tab="individual">ÙØ±Ø¯</button>
          <button class="tab" data-tab="entity">Ø¬Ù‡Ø©</button>
          <button class="tab" data-tab="sponsor">Ø±Ø§Ø¹Ù</button>
          <button class="tab" data-tab="admin">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
          <button class="tab" data-tab="investor">Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±</button>
          <button class="cta">Ø§Ø¨Ø¯Ø£</button>
        </div>
      </div>
    </header>

    <main id="view"></main>

    <footer class="footer">
      <div class="footer-inner">
        <div>Â© <span id="y"></span> Musabaqa â€” Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</div>
        <div style="display:flex;gap:16px">
          <a href="#" class="muted">Ø§Ù„Ø®ØµÙˆØµÙŠØ©</a>
          <a href="#" class="muted">Ø§Ù„Ø´Ø±ÙˆØ·</a>
          <a href="#" class="muted">Ø§Ù„Ø¯Ø¹Ù…</a>
        </div>
      </div>
    </footer>

    <script>
      document.getElementById('y').textContent = new Date().getFullYear();

      // State
      const view = document.getElementById('view');
      const state = {
        route: 'landing',
        competitions: [
          { id: 'c1', title:'Ø§Ù„ØªÙˆØ¹ÙŠØ© Ø¨Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø±Ù‚Ù…ÙŠ', type:'ØªÙˆØ¹ÙˆÙŠØ©', owner:'ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…', city:'Ø§Ù„Ø±ÙŠØ§Ø¶', prize:1000, prizeType:'Ø±Ù‚Ù…ÙŠØ©', status:'Ù…ÙØªÙˆØ­Ø©', winners:3, participants:[], requiresCode:true, accessCode:'SEC-2030', videoUrl:'', target:{cities:['Ø§Ù„Ø±ÙŠØ§Ø¶'], minAge:16, maxAge:60, interests:['Ø§Ù„ØªÙ‚Ù†ÙŠØ©']} },
          { id: 'c2', title:'ØªØ­Ø¯ÙŠ Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø¬Ø¯ÙŠØ¯', type:'ØªØ³ÙˆÙŠÙ‚ÙŠØ©', owner:'Ø´Ø±ÙƒØ© ØªÙ…ÙˆÙŠÙ† Ø§Ù„ØºØ°Ø§Ø¡', city:'Ø¬Ø¯Ø©', prize:5000, prizeType:'Ø¹ÙŠÙ†ÙŠØ©', status:'Ù…ÙØªÙˆØ­Ø©', winners:1, participants:[], requiresCode:false, accessCode:'', videoUrl:'', target:{cities:['Ø¬Ø¯Ø©'], minAge:18, maxAge:55, interests:['Ø§Ù„ØªØ³ÙˆÙŠÙ‚','Ø§Ù„Ø§Ø¨Ø¯Ø§Ø¹']} },
          { id: 'c3', title:'Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø¨ÙŠØ¦Ø© â€“ ÙÙƒØ±Ø© Ù…Ø¨ØªÙƒØ±Ø© Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù‡Ø¯Ø±', type:'ØªÙˆØ¹ÙˆÙŠØ©', owner:'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ¦Ø©', city:'Ø§Ù„Ø¯Ù…Ø§Ù…', prize:3000, prizeType:'Ù†Ù‚Ø¯ÙŠØ©', status:'Ù…ØºÙ„Ù‚Ø©', winners:2, participants:[{user:'Ø³Ø§Ø±Ø©', city:'Ø§Ù„Ø±ÙŠØ§Ø¶'},{user:'Ø®Ø§Ù„Ø¯', city:'Ø§Ù„Ø¯Ù…Ø§Ù…'}], requiresCode:false, accessCode:'', videoUrl:'', target:{cities:['Ø§Ù„Ø¯Ù…Ø§Ù…'], minAge:15, maxAge:60, interests:['Ø§Ù„Ø¨ÙŠØ¦Ø©']} }
        ],
        user: { name:'ÙÙ‡Ø¯', city:'Ø§Ù„Ø±ÙŠØ§Ø¶', age:24, interests:['Ø§Ù„Ø«Ù‚Ø§ÙØ©','Ø§Ù„ØªÙ‚Ù†ÙŠØ©','Ø§Ù„Ø±ÙŠØ§Ø¶Ø©'] },
        sponsor: { org:'Ø´Ø±ÙƒØ© ØªÙ…ÙˆÙŠÙ† Ø§Ù„ØºØ°Ø§Ø¡', wallet:25000 }
      };

      // Utils
      function SAR(n){ return new Intl.NumberFormat('ar-SA',{style:'currency',currency:'SAR'}).format(n); }
      function fmt(n){ return new Intl.NumberFormat('ar-SA').format(n); }
      function copy(text){ navigator.clipboard.writeText(text).then(()=>alert('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· ğŸ‘')); }
      function Pill(txt){ return `<span class="pill">${txt}</span>`; }
      function Stat(label, value, sub){ return `<div class="card"><div class="stat-value">${value}</div><div class="stat-title">${label}</div>${sub?`<div class="muted" style="font-size:12px;margin-top:4px">${sub}</div>`:''}</div>`; }
      function AccountCard(key, title, desc){ return `<div class="card" data-go="${key}" style="cursor:pointer"><div style="font-weight:700">${title}</div><div class="muted" style="margin-top:4px">${desc}</div></div>`; }
      function val(id){ const el = document.getElementById(id); return el?el.value:''; }
      function isTargeted(c){ // simple targeting: city match + age within + any shared interest
        const cityOK = c.target.cities.length? c.target.cities.includes(state.user.city) : true;
        const ageOK = (!c.target.minAge || state.user.age>=c.target.minAge) && (!c.target.maxAge || state.user.age<=c.target.maxAge);
        const interestsOK = c.target.interests.length? c.target.interests.some(x=> state.user.interests.includes(x)) : true;
        return cityOK && ageOK && interestsOK;
      }

      function render(){
        const active = state.competitions.filter(c=> c.status!=='Ù…ØºÙ„Ù‚Ø©').length;
        const participations = state.competitions.reduce((a,c)=> a + c.participants.length, 0);
        const prizesClosed = state.competitions.filter(c=> c.status==='Ù…ØºÙ„Ù‚Ø©').reduce((a,c)=> a + c.winners, 0);
        const prizeValue = state.competitions.reduce((a,c)=> a + c.prize, 0);
        const sponsors = 7;
        const users = 58000;

        const R = {
          landing: `
            <section class="container">
              <div class="grid grid-2" style="align-items:center">
                <div>
                  <h1 class="hero-title">Ù…Ø³Ø§Ø¨Ù‚Ø© â€” Ø®ÙŠØ§Ø±Ùƒ Ø§Ù„Ø£Ù…Ø«Ù„ Ù„Ù„Ù…Ø³Ø§Ø¨Ù‚Ø§Øª <span style="color:#6d93ff">Ø§Ù„ØªØ³ÙˆÙŠÙ‚ÙŠØ©</span> Ùˆ<span style="color:#22d3ee">Ø§Ù„ØªÙˆØ¹ÙˆÙŠØ©</span></h1>
                  <p class="hero-sub">Ø§Ø³ØªÙ‡Ø¯Ø§Ù Ø¯Ù‚ÙŠÙ‚ + ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù‚ØµÙŠØ±Ø© + Ø±Ù…Ø² Ø¯Ø®ÙˆÙ„ Ù…Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙŠÙ…Ù†Ø¹ Ø§Ù„ØªØ®Ø·ÙŠ + Ù…Ø´Ø§Ø±ÙƒØ© Ø®Ø§Ø±Ø¬ÙŠØ© ÙˆØ¯Ø§Ø®Ù„ÙŠØ©.</p>
                  <div style="display:flex;flex-wrap:wrap;gap:8px;margin-top:8px">
                    <button class="btn-accent" data-go="individual">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯ÙŠ (ÙØ±Ø¯)</button>
                    <button class="btn" data-go="entity">Ù„Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ©/ØºÙŠØ± Ø§Ù„Ø±Ø¨Ø­ÙŠØ©</button>
                    <button class="btn" data-go="sponsor">Ù„Ù„Ø±Ø¹Ø§Ø© ÙˆØ§Ù„Ø´Ø±ÙƒØ§Øª</button>
                    <button class="btn-ghost" data-go="investor">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±</button>
                  </div>
                  <div style="display:flex;gap:8px;margin-top:10px;flex-wrap:wrap">
                    ${Pill('Ø§Ø³ØªÙ‡Ø¯Ø§Ù Ø¯Ù‚ÙŠÙ‚')} ${Pill('Ø±Ù…Ø² Ù…Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ')} ${Pill('Ù†Ø´Ø± Ø®Ø§Ø±Ø¬ÙŠ/Ø¯Ø§Ø®Ù„ÙŠ')} ${Pill('ØªÙ‚Ø§Ø±ÙŠØ± ROI')}
                  </div>
                </div>
                <div class="card">
                  <div class="kpis">
                    ${Stat('Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©', fmt(active))}
                    ${Stat('Ù…Ø´Ø§Ø±ÙƒØ§Øª', fmt(participations))}
                    ${Stat('Ø¬ÙˆØ§Ø¦Ø² Ù…ÙØ³Ù„Ù‘ÙÙ…Ø©', fmt(prizesClosed))}
                    ${Stat('Ø±Ø¹Ø§Ø© Ù†Ø´Ø·ÙˆÙ†', fmt(sponsors))}
                    ${Stat('Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¬ÙˆØ§Ø¦Ø²', SAR(prizeValue))}
                    ${Stat('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†', fmt(users))}
                  </div>
                </div>
              </div>

              <h3 style="font-size:18px;font-weight:700;margin:14px 0 8px">Ù…Ù† ÙŠØ®Ø¯Ù…Ù‡Ù… Ø§Ù„Ù†Ø¸Ø§Ù…ØŸ</h3>
              <div class="grid grid-4">
                ${AccountCard('individual','Ø§Ù„Ø£ÙØ±Ø§Ø¯','Ù…Ø´Ø§Ø±ÙƒØ©/Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø¨Ù‚Ø§Øª ÙˆØ§Ø³ØªÙ„Ø§Ù… Ø¬ÙˆØ§Ø¦Ø²')}
                ${AccountCard('entity','Ø¬Ù‡Ø§Øª Ø­ÙƒÙˆÙ…ÙŠØ©/ØºÙŠØ± Ø±Ø¨Ø­ÙŠØ©','Ø¥Ø·Ù„Ø§Ù‚ Ù…Ø³Ø§Ø¨Ù‚Ø§Øª ØªÙˆØ¹ÙˆÙŠØ© ÙˆØªÙ‚Ø§Ø±ÙŠØ± Ø£Ø«Ø±')}
                ${AccountCard('sponsor','Ø§Ù„Ø´Ø±ÙƒØ§Øª/Ø§Ù„Ø±Ø¹Ø§Ø©','Ø±Ø¹Ø§ÙŠØ©/Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø¨Ù‚Ø§Øª ÙˆØªØ­Ù„ÙŠÙ„ ROI')}
                ${AccountCard('investor','Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±','Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ§Ù„Ù†Ù…Ùˆ Ø§Ù„Ù…Ø§Ù„ÙŠ')}
              </div>
            </section>
          `,
          individual: `
            <section class="container">
              <h2 style="font-size:22px;font-weight:800;margin-bottom:10px">Ù…Ø±Ø­Ø¨Ù‹Ø§ ${state.user.name} ğŸ‘‹</h2>
              <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px">
                ${Pill('Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©: '+state.user.city)} ${Pill('Ø§Ù„Ø¹Ù…Ø±: '+state.user.age)} ${Pill('Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª: '+state.user.interests.join('ØŒ '))}
              </div>
              <div class="grid grid-2">
                ${state.competitions.filter(c=> c.status!=='Ù…ØºÙ„Ù‚Ø©').map(c => `
                  <article class="card">
                    <div style="display:flex;align-items:center;justify-content:space-between;gap:10px">
                      <h4 style="margin:0;font-weight:800">${c.title}</h4>
                      ${Pill(c.type)}
                    </div>
                    <div class="muted" style="margin-top:4px">${c.owner} â€¢ ${c.city}</div>
                    <div style="margin-top:8px;font-size:14px">Ø§Ù„Ø¬Ø§Ø¦Ø²Ø©: ${SAR(c.prize)} (${c.prizeType}) â€¢ ÙØ§Ø¦Ø²ÙˆÙ†: ${c.winners}</div>
                    ${c.videoUrl ? `<div class="video"><iframe src="${c.videoUrl}" width="100%" height="100%" frameborder="0" allowfullscreen></iframe></div>` : ''}
                    ${c.requiresCode ? `<div class="hint" style="margin-top:6px">Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø© ØªØªØ·Ù„Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù…Ø² ÙŠØ¸Ù‡Ø± Ø¯Ø§Ø®Ù„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ/Ø§Ù„Ø¨ÙˆØ³Øª</div>`:''}
                    <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px">
                      <input class="input" ${c.requiresCode?'':'disabled'} placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø² Ø¥Ù† Ø·ÙÙ„Ø¨" data-code="${c.id}"/>
                      <textarea class="textarea" data-answer="${c.id}" placeholder="Ø§ÙƒØªØ¨ Ø¥Ø¬Ø§Ø¨ØªÙƒ Ø¨Ø¥ÙŠØ¬Ø§Ø²"></textarea>
                    </div>
                    <div style="display:flex;gap:8px;margin-top:8px;flex-wrap:wrap">
                      <button class="btn-accent" data-participate="${c.id}">Ø£Ø´Ø§Ø±Ùƒ Ø§Ù„Ø¢Ù†</button>
                      <button class="btn-ghost" data-share="${c.id}">Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©</button>
                      ${isTargeted(c) ? Pill('Ù…Ø·Ø§Ø¨Ù‚ Ù„Ù„Ø§Ø³ØªÙ‡Ø¯Ø§Ù âœ…') : Pill('Ø®Ø§Ø±Ø¬ Ø§Ù„Ø§Ø³ØªÙ‡Ø¯Ø§Ù âš ï¸')}
                    </div>
                  </article>
                `).join('')}
              </div>
            </section>
          `,
          entity: creationForm('Ø¬Ù‡Ø© Ø­ÙƒÙˆÙ…ÙŠØ©/ØºÙŠØ± Ø±Ø¨Ø­ÙŠØ©', 'gov'),
          sponsor: creationForm('Ø±Ø§Ø¹Ù/Ø´Ø±ÙƒØ©', 'sponsor'),
          admin: `
            <section class="container">
              <h2 style="font-size:22px;font-weight:800;margin-bottom:10px">Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h2>
              <div class="grid grid-2">
                ${state.competitions.map(c => `
                  <div class="card">
                    <div style="display:flex;align-items:center;justify-content:space-between;gap:10px">
                      <div style="font-weight:800">${c.title}</div> ${Pill(c.status)}
                    </div>
                    <div class="muted" style="margin-top:4px">${c.owner} â€¢ ${c.type} â€¢ ${c.city}</div>
                    <div style="font-size:14px;margin-top:8px">Ù…Ø´Ø§Ø±ÙƒÙˆÙ†: ${c.participants.length} â€¢ Ø§Ù„Ø¬Ø§Ø¦Ø²Ø©: ${SAR(c.prize)} â€¢ ÙØ§Ø¦Ø²ÙˆÙ†: ${c.winners}</div>
                    <div style="display:flex;gap:8px;margin-top:8px;flex-wrap:wrap">
                      ${c.status!=='Ù…ØºÙ„Ù‚Ø©' ? `<button class="btn" data-close="${c.id}">Ø¥ØºÙ„Ø§Ù‚</button>` : ''}
                      <button class="btn-accent" data-pick="${c.id}">ÙØ±Ø² Ø§Ù„ÙØ§Ø¦Ø²ÙŠÙ†</button>
                    </div>
                  </div>
                `).join('')}
              </div>
            </section>
          `,
          investor: `
            <section class="container">
              <h2 style="font-size:22px;font-weight:800;margin-bottom:10px">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±</h2>
              <div class="grid grid-3">
                ${Stat('Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†', fmt(users), 'Ù†Ù…Ùˆ Ø´Ù‡Ø±ÙŠ 12%')}
                ${Stat('Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø´Ù‡Ø±ÙŠØ©', SAR(185000), 'ØªØ±Ø§ÙƒÙ…ÙŠ ØªØ¬Ø±ÙŠØ¨ÙŠ')}
                ${Stat('Ø±Ø¹Ø§Ø© Ù†Ø´Ø·ÙˆÙ†', fmt(sponsors))}
              </div>
              <div class="card" style="margin-top:12px">
                <h3 style="font-size:18px;font-weight:700;margin-bottom:8px">Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©</h3>
                <div class="grid grid-2">
                  ${Stat('Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ù†Ø´Ø·Ø©', fmt(active))}
                  ${Stat('Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¬ÙˆØ§Ø¦Ø² Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©', SAR(prizeValue))}
                </div>
                <div class="muted" style="margin-top:8px">* Ù‡Ø°Ù‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ø§ÙƒØ§Ø© Ù„Ù„Ø¹Ø±Ø¶ ÙÙ‚Ø· â€” ÙŠÙ…ÙƒÙ† Ø±Ø¨Ø·Ù‡Ø§ Ø¨Ù…ØµØ¯Ø± Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ù‚ÙŠÙ‚ÙŠ Ù„Ø§Ø­Ù‚Ù‹Ø§.</div>
              </div>
            </section>
          `
        };

        view.innerHTML = R[state.route];

        // Wire interactions
        document.querySelectorAll('[data-go]').forEach(b => b.addEventListener('click', e => routeTo(e.target.getAttribute('data-go'))));

        // Individual actions
        document.querySelectorAll('[data-share]').forEach(btn => btn.addEventListener('click', e => {
          const cid = e.target.getAttribute('data-share');
          const c = state.competitions.find(x=> x.id===cid);
          const token = c.requiresCode ? `&token=${encodeURIComponent(c.accessCode)}` : '';
          const link = `${location.origin}${location.pathname}?cid=${encodeURIComponent(cid)}${token}`;
          copy(link);
        }));

        document.querySelectorAll('[data-participate]').forEach(btn => btn.addEventListener('click', e => {
          const cid = e.target.getAttribute('data-participate');
          const c = state.competitions.find(x=> x.id===cid);
          const ta = document.querySelector(`[data-answer="${cid}"]`);
          const codeInput = document.querySelector(`[data-code="${cid}"]`);
          const answer = (ta && ta.value || '').trim();
          const code = codeInput ? (codeInput.value||'').trim() : '';
          if(!answer){ alert('ÙØ¶Ù„Ø§Ù‹ Ø§ÙƒØªØ¨ Ù…Ø´Ø§Ø±ÙƒØªÙƒ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„'); return; }
          if(c.requiresCode && code !== c.accessCode){ alert('Ø±Ù…Ø² Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­'); return; }
          c.participants.push({ user: state.user.name, city: state.user.city, answer });
          if(ta) ta.value = ''; if(codeInput) codeInput.value='';
          alert('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ù…Ø´Ø§Ø±ÙƒØªÙƒ Ø¨Ù†Ø¬Ø§Ø­ âœ…');
        }));

        // Creation forms (entity/sponsor)
        const createBtn = document.getElementById('create-btn');
        if(createBtn){
          createBtn.addEventListener('click', () => {
            const entry = {
              id: 'c'+Date.now(),
              title: val('f-title') || 'Ù…Ø³Ø§Ø¨Ù‚Ø© Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†',
              type: val('f-type'),
              owner: val('f-owner') || (createBtn.dataset.kind==='gov'?'Ø¬Ù‡Ø© Ø­ÙƒÙˆÙ…ÙŠØ©':'Ø±Ø§Ø¹Ù'),
              city: val('f-city'),
              prize: Number(val('f-prize'))||0,
              prizeType: val('f-ptype'),
              status: 'Ù…ÙØªÙˆØ­Ø©',
              winners: Number(val('f-winners'))||1,
              videoUrl: val('f-video'),
              requiresCode: document.getElementById('f-req').checked,
              accessCode: val('f-code'),
              target: {
                cities: val('f-tcities').split(',').map(s=>s.trim()).filter(Boolean),
                minAge: Number(val('f-minage'))||0,
                maxAge: Number(val('f-maxage'))||0,
                interests: val('f-interests').split(',').map(s=>s.trim()).filter(Boolean)
              },
              participants: []
            };
            state.competitions.unshift(entry);
            alert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø© ÙˆÙ†Ø´Ø±Ù‡Ø§ âœ…');
            routeTo('admin');
          });
        }

        // Admin actions
        document.querySelectorAll('[data-close]').forEach(btn => btn.addEventListener('click', e => {
          const cid = e.target.getAttribute('data-close');
          const c = state.competitions.find(x=> x.id===cid);
          c.status = 'Ù…ØºÙ„Ù‚Ø©';
          render();
        }));
        document.querySelectorAll('[data-pick]').forEach(btn => btn.addEventListener('click', e => {
          const cid = e.target.getAttribute('data-pick');
          const c = state.competitions.find(x=> x.id===cid);
          const shuffled = c.participants.slice().sort(()=> Math.random()-0.5);
          const winners = shuffled.slice(0, c.winners);
          alert(`ØªÙ… Ø§Ø®ØªÙŠØ§Ø± ${winners.length} ÙØ§Ø¦Ø²/Ø©:\n` + winners.map(w=>`â€¢ ${w.user} (${w.city})`).join('\n'));
        }));

        // Deep link: ?cid=...&token=...
        const url = new URL(location.href);
        const deepCid = url.searchParams.get('cid');
        const token = url.searchParams.get('token') || '';
        if(deepCid){
          routeTo('individual');
          setTimeout(()=>{
            const codeInp = document.querySelector(`[data-code="${deepCid}"]`);
            if(codeInp && token) codeInp.value = token;
          }, 0);
        }
      }

      function routeTo(tab){
        state.route = tab;
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('tab-active'));
        const btn = document.querySelector(`.tab[data-tab="${tab}"]`);
        if(btn) btn.classList.add('tab-active');
        render();
        window.scrollTo({top:0, behavior:'smooth'});
      }

      function creationForm(label, kind){
        return `
          <section class="container">
            <h2 style="font-size:22px;font-weight:800;margin-bottom:10px">Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø¨Ù‚Ø© (${label})</h2>
            <div class="card">
              <div class="grid grid-2">
                <input id="f-title" class="input" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø©" />
                <select id="f-type" class="input"><option>ØªÙˆØ¹ÙˆÙŠØ©</option><option>Ø«Ù‚Ø§ÙÙŠØ©</option><option>ØªØ³ÙˆÙŠÙ‚ÙŠØ©</option></select>
                <input id="f-owner" class="input" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¬Ù‡Ø©/Ø§Ù„Ø´Ø±ÙƒØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" />
                <select id="f-city" class="input"><option>Ø§Ù„Ø±ÙŠØ§Ø¶</option><option>Ø¬Ø¯Ø©</option><option>Ø§Ù„Ø¯Ù…Ø§Ù…</option></select>
                <input id="f-winners" class="input" type="number" min="1" value="1" />
                <input id="f-prize" class="input" type="number" min="0" value="1000" />
                <select id="f-ptype" class="input"><option>Ø±Ù‚Ù…ÙŠØ©</option><option>Ù†Ù‚Ø¯ÙŠØ©</option><option>Ø¹ÙŠÙ†ÙŠØ©</option></select>
                <input id="f-video" class="input" placeholder="Ø±Ø§Ø¨Ø· ÙÙŠØ¯ÙŠÙˆ (YouTube/Vimeo/Embed)" />
              </div>
              <h3 style="font-size:16px;font-weight:700;margin:10px 0 6px">Ø§Ù„Ø§Ø³ØªÙ‡Ø¯Ø§Ù Ø§Ù„Ø¯Ù‚ÙŠÙ‚</h3>
              <div class="grid grid-2">
                <input id="f-tcities" class="input" placeholder="Ù…Ø¯Ù† Ù…Ø³ØªÙ‡Ø¯ÙØ© Ù…ÙØµÙˆÙ„Ø© Ø¨ÙÙˆØ§ØµÙ„ (Ù…Ø«Ø§Ù„: Ø§Ù„Ø±ÙŠØ§Ø¶, Ø¬Ø¯Ø©)" />
                <input id="f-interests" class="input" placeholder="Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª Ù…Ø³ØªÙ‡Ø¯ÙØ© (Ù…Ø«Ø§Ù„: Ø§Ù„ØªÙ‚Ù†ÙŠØ©, Ø§Ù„Ø¨ÙŠØ¦Ø©)" />
                <input id="f-minage" class="input" type="number" min="0" placeholder="Ø§Ù„Ø¹Ù…Ø± Ø§Ù„Ø£Ø¯Ù†Ù‰" />
                <input id="f-maxage" class="input" type="number" min="0" placeholder="Ø§Ù„Ø¹Ù…Ø± Ø§Ù„Ø£Ù‚ØµÙ‰" />
              </div>
              <h3 style="font-size:16px;font-weight:700;margin:10px 0 6px">Ø§Ù„Ø±Ù…Ø² Ù…Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Ù„Ù…Ù†Ø¹ Ø§Ù„ØªØ®Ø·ÙŠ)</h3>
              <div class="grid grid-2">
                <label style="display:flex;align-items:center;gap:8px"><input id="f-req" type="checkbox"/> ØªÙØ¹ÙŠÙ„ Ø§Ø´ØªØ±Ø§Ø· Ø§Ù„Ø±Ù…Ø²</label>
                <input id="f-code" class="input" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø°ÙŠ Ø³ÙŠØ¸Ù‡Ø± Ø¯Ø§Ø®Ù„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ/Ø§Ù„Ø¨ÙˆØ³Øª" />
              </div>
              <h3 style="font-size:16px;font-weight:700;margin:10px 0 6px">Ø§Ù„Ù†Ø´Ø± ÙˆØ§Ù„Ù…Ø´Ø§Ø±ÙƒØ©</h3>
              <div class="share">
                <span class="pill">Ù†Ø´Ø± Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ù†ØµØ© (Ø¹Ø§Ù…)</span>
                <span class="pill">Ù†Ø´Ø± Ù„Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© ÙÙ‚Ø·</span>
                <span class="pill">Ù…Ø´Ø§Ø±ÙƒØ© Ø®Ø§Ø±Ø¬ÙŠØ© (ÙˆØ§ØªØ³Ø§Ø¨/ØªÙˆÙŠØªØ±/Ø³Ù†Ø§Ø¨)</span>
              </div>
              <div style="margin-top:10px"><button class="btn-accent" id="create-btn" data-kind="${kind}">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø©</button></div>
              <div class="muted" style="margin-top:6px;font-size:12px">* Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙŠÙ…ÙƒÙ†Ùƒ Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø© Ù…Ø¹ ØªØ¶Ù…ÙŠÙ† Ø§Ù„Ø±Ù…Ø² Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ù…Ù† Ù‚Ø³Ù… Ø§Ù„Ø£ÙØ±Ø§Ø¯.</div>
            </div>
          </section>
        `;
      }

      // Init
      document.querySelectorAll('.tab').forEach(btn => btn.addEventListener('click', e => routeTo(btn.getAttribute('data-tab'))));
      render();
    </script>
  </body>
</html>
